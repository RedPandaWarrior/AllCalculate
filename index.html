<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能房贷计算器 - 精准计算您的月供</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7523300043836806"
     crossorigin="anonymous"></script>
    <meta name="description" content="免费在线房贷计算器，精准计算每月还款额、总利息和还款总额，支持等额本息和等额本金两种方式。">
    <!-- 引入 Vue 3 和 Element Plus -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <script src="https://unpkg.com/element-plus/dist/index.full.js"></script>
    <!-- 引入 math.js 用于精确计算 -->
    <script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Helvetica Neue', Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px; display: flex; justify-content: center; align-items: center;
        }
        .calculator-container {
            background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
            width: 100%; max-width: 500px; padding: 30px;
        }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
        .header p { color: #7f8c8d; font-size: 16px; }
        .input-section { margin-bottom: 25px; }
        .result-section {
            background: #f8f9fa; border-radius: 10px; padding: 20px; margin-top: 20px;
            border-left: 4px solid #3498db;
        }
        .result-item { 
            display: flex; justify-content: space-between; margin-bottom: 10px; 
            padding: 8px 0; border-bottom: 1px solid #ecf0f1;
        }
        .result-item:last-child { 
            border-bottom: none; margin-bottom: 0; font-weight: bold; color: #2c3e50;
        }
        .result-value { color: #e74c3c; font-weight: bold; font-size: 18px; }
        .calculate-btn { width: 100%; height: 50px; font-size: 18px; }
        .tips { 
            margin-top: 20px; padding: 15px; background: #e8f4fd; border-radius: 5px; 
            border-left: 4px solid #3498db; font-size: 14px; color: #2c3e50;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="calculator-container">
            <div class="header">
                <h1>智能房贷计算器</h1>
                <p>精准计算您的月供和还款计划</p>
            </div>

            <el-form class="input-section" label-width="100px">
                <el-form-item label="贷款总额">
                    <el-input 
                        v-model="loanAmount" 
                        placeholder="请输入贷款金额"
                        @input="calculateMortgage"
                    >
                        <template #append>万元</template>
                    </el-input>
                </el-form-item>

                <el-form-item label="贷款年限">
                    <el-slider 
                        v-model="loanYears" 
                        :min="1" :max="30" 
                        :marks="yearMarks"
                        @change="calculateMortgage"
                    ></el-slider>
                    <span style="margin-left: 10px;">{{ loanYears }} 年</span>
                </el-form-item>

                <el-form-item label="年利率">
                    <el-slider
                        v-model="interestRate"
                        :min="3" :max="8"
                        :step="0.1"
                        @change="calculateMortgage"
                    ></el-slider>
                    <span style="margin-left: 10px;">{{ interestRate }} %</span>
                </el-form-item>

                <el-form-item label="还款方式">
                    <el-radio-group v-model="repaymentMethod" @change="calculateMortgage">
                        <el-radio label="equalPrincipal">等额本金</el-radio>
                        <el-radio label="equalInstallment">等额本息</el-radio>
                    </el-radio-group>
                </el-form-item>
            </el-form>

            <el-button 
                type="primary" 
                class="calculate-btn"
                @click="calculateMortgage"
                :loading="calculating"
            >
                {{ calculating ? '计算中...' : '立即计算' }}
            </el-button>

            <div class="result-section" v-if="showResults">
                <div class="result-item">
                    <span>每月还款：</span>
                    <span class="result-value">{{ monthlyPayment }} 元</span>
                </div>
                <div class="result-item">
                    <span>总利息：</span>
                    <span class="result-color">{{ totalInterest }} 元</span>
                </div>
                <div class="result-item">
                    <span>还款总额：</span>
                    <span class="result-color">{{ totalPayment }} 元</span>
                </div>
                <div class="result-item">
                    <span>利息占比：</span>
                    <span class="result-color">{{ interestPercentage }}%</span>
                </div>
            </div>

            <div class="tips">
                <strong>温馨提示：</strong>本计算器结果仅供参考，实际贷款利率和金额以银行最终审批为准。
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        const { ElMessage } = ElementPlus;

        createApp({
            data() {
                return {
                    loanAmount: 100,
                    loanYears: 20,
                    interestRate: 4.5,
                    repaymentMethod: 'equalInstallment',
                    calculating: false,
                    showResults: false,
                    monthlyPayment: 0,
                    totalInterest: 0,
                    totalPayment: 0,
                    interestPercentage: 0,
                    yearMarks: {
                        5: '5年', 10: '10年', 20: '20年', 30: '30年'
                    }
                }
            },
            mounted() {
                this.calculateMortgage();
            },
            methods: {
                calculateMortgage() {
                    this.calculating = true;
                    this.showResults = false;

                    setTimeout(() => {
                        try {
                            const principal = this.loanAmount * 10000;
                            const monthlyRate = this.interestRate / 100 / 12;
                            const totalMonths = this.loanYears * 12;

                            if (this.repaymentMethod === 'equalInstallment') {
                                this.calculateEqualInstallment(principal, monthlyRate, totalMonths);
                            } else {
                                this.calculateEqualPrincipal(principal, monthlyRate, totalMonths);
                            }

                            this.showResults = true;
                        } catch (error) {
                            ElMessage.error('计算错误，请检查输入数据');
                            console.error(error);
                        } finally {
                            this.calculating = false;
                        }
                    }, 300);
                },

                calculateEqualInstallment(principal, monthlyRate, totalMonths) {
                    if (monthlyRate === 0) {
                        this.monthlyPayment = principal / totalMonths;
                    } else {
                        const factor = math.pow(1 + monthlyRate, totalMonths);
                        this.monthlyPayment = principal * monthlyRate * factor / (factor - 1);
                    }
                    
                    this.monthlyPayment = math.round(this.monthlyPayment, 2);
                    this.totalPayment = math.round(this.monthlyPayment * totalMonths, 2);
                    this.totalInterest = math.round(this.totalPayment - principal, 2);
                    this.interestPercentage = math.round((this.totalInterest / this.totalPayment) * 100, 1);
                },

                calculateEqualPrincipal(principal, monthlyRate, totalMonths) {
                    const monthlyPrincipal = principal / totalMonths;
                    let totalInterest = 0;

                    for (let i = 0; i < totalMonths; i++) {
                        const remainingPrincipal = principal - (monthlyPrincipal * i);
                        totalInterest += remainingPrincipal * monthlyRate;
                    }

                    const firstMonthPayment = monthlyPrincipal + (principal * monthlyRate);
                    this.monthlyPayment = math.round(firstMonthPayment, 2);
                    this.totalInterest = math.round(totalInterest, 2);
                    this.totalPayment = math.round(principal + totalInterest, 2);
                    this.interestPercentage = math.round((totalInterest / this.totalPayment) * 100, 1);
                }
            }
        }).use(ElementPlus).mount('#app');
    </script>
</body>
</html>